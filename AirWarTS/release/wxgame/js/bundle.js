var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();!function(){function t(e,i,o){function a(r,n){if(!i[r]){if(!e[r]){var h="function"==typeof require&&require;if(!n&&h)return h(r,!0);if(s)return s(r,!0);var p=new Error("Cannot find module '"+r+"'");throw p.code="MODULE_NOT_FOUND",p}var l=i[r]={exports:{}};e[r][0].call(l.exports,function(t){return a(e[r][1][t]||t)},l,l.exports,t,e,i,o)}return i[r].exports}for(var s="function"==typeof require&&require,r=0;r<o.length;r++)a(o[r]);return a}return t}()({1:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.updateMap=function(){this.y+=1,this.bg1.y+this.y>=1280&&(this.bg1.y-=2560),this.bg2.y+this.y>=1280&&(this.bg2.y-=2560)},e}(t("./ui/layaMaxUI").ui.GameBgUI);i.default=o},{"./ui/layaMaxUI":7}],2:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function e(){var e=t.call(this)||this;return e.btn_restart.on(Laya.Event.MOUSE_DOWN,e,e.onRestart),e}return __extends(e,t),e.prototype.onRestart=function(){this.ani_restart.play(0,!1),this.ani_restart.once(Laya.Event.COMPLETE,this,this.AniComplete)},e.prototype.AniComplete=function(){this.event("reStart"),this.close()},e}(t("./ui/layaMaxUI").ui.GameOverUI);i.default=o},{"./ui/layaMaxUI":7}],3:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function e(){var e=t.call(this)||this;return e.btn_pause.on(Laya.Event.MOUSE_DOWN,e,e.onPause),e}return __extends(e,t),e.prototype.onPause=function(){this.gamePause.visible=!0,this.gamePause.once(Laya.Event.MOUSE_DOWN,this,this.onContinue),Laya.timer.scale=0},e.prototype.onContinue=function(){Laya.timer.scale=1,this.gamePause.visible=!1},e.prototype.update=function(t,e,i){this.txt_hp.text="HP:"+t,this.txt_level.text="LEVEL:"+e,this.txt_score.text="SCORE:"+i},e}(t("./ui/layaMaxUI").ui.GamePlayUI);i.default=o},{"./ui/layaMaxUI":7}],4:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function e(){var e=t.call(this)||this;return e.assetArr=[{url:"res/atlas/gameRole.atlas"},{url:"sound/achievement.mp3",type:Laya.Loader.SOUND},{url:"sound/bullet.mp3",type:Laya.Loader.SOUND},{url:"sound/game_over.mp3",type:Laya.Loader.SOUND},{url:"sound/enemy1_die.mp3",type:Laya.Loader.SOUND},{url:"sound/enemy3_out.mp3",type:Laya.Loader.SOUND}],e.btn_start.visible=!1,e.once(laya.events.Event.CLOSE,e,e.onClose),Laya.loader.load(e.assetArr,Laya.Handler.create(e,e.onComplete),Laya.Handler.create(e,e.onProgress)),e}return __extends(e,t),e.prototype.onComplete=function(){this.txt_load.text="资源加载完成,开始游戏吧...",this.btn_start.visible=!0,Laya.Tween.from(this.btn_start,{y:this.btn_start.y+20},1e3,Laya.Ease.elasticOut)},e.prototype.onProgress=function(t){this.txt_load.text="资源加载中，当前进度："+100*t+"%"},e.prototype.onClose=function(){this.removeSelf(),this.destroy()},e}(t("./ui/layaMaxUI").ui.GameStartUI);i.default=o},{"./ui/layaMaxUI":7}],5:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=Laya.WebGL,a=Laya.Stage,s=laya.events.Event,r=t("./GameStart"),n=t("./GameMap"),h=t("./GamePlay"),p=t("./GameOver"),l=t("./Role"),u=function(){function t(){this.hps=[1,7,15],this.nums=[2,1,1],this.speeds=[3,2,1],this.radius=[20,35,80],this.deathTime=0,this.createTime=0,this.speedUp=0,this.hpUp=0,this.numUp=0,this.levelUpScore=10,Laya.init(720,1280,o),Laya.stage.scaleMode=a.SCALE_EXACTFIT,Laya.loader.load("res/atlas/gameUI.atlas",laya.utils.Handler.create(this,this.GameStart))}return t.prototype.GameStart=function(){this.start=new r.default,this.start.popup(),this.start.btn_start.on(s.MOUSE_UP,this,this.gameInit)},t.prototype.gameInit=function(){this.start.close(),t.level=1,t.score=0,this.createTime=0,this.speedUp=0,this.hpUp=0,this.numUp=0,this.levelUpScore=10,null==this.map&&(this.map=new n.default),Laya.stage.addChild(this.map),null==this.roleLayer&&(this.roleLayer=new Laya.Sprite),Laya.stage.addChild(this.roleLayer),null==this.play&&(this.play=new h.default),Laya.stage.addChild(this.play),null==this.hero&&(this.hero=new l.default),this.hero.init("hero",10,0,30,0),this.hero.visible=!0,this.hero.pos(360,800),this.roleLayer.addChild(this.hero),Laya.stage.on(s.MOUSE_DOWN,this,this.onMouseDown),Laya.stage.on(s.MOUSE_UP,this,this.onMouseUp),Laya.timer.frameLoop(1,this,this.loop)},t.prototype.onMouseDown=function(){this.moveX=Laya.stage.mouseX,this.moveY=Laya.stage.mouseY,Laya.stage.on(s.MOUSE_MOVE,this,this.onMouseMove)},t.prototype.onMouseMove=function(){var t=this.moveX-Laya.stage.mouseX,e=this.moveY-Laya.stage.mouseY;this.hero.x-=t,this.hero.y-=e,this.moveX=Laya.stage.mouseX,this.moveY=Laya.stage.mouseY},t.prototype.onMouseUp=function(){Laya.stage.off(s.MOUSE_MOVE,this,this.onMouseMove)},t.prototype.loop=function(){if(this.play.update(this.hero.hp,t.level,t.score),this.hero.hp<=0){if(this.deathTime++,this.deathTime>=100)return this.deathTime=0,void this.gameOver()}else this.hero.shoot(),this.levelUp();this.map.updateMap();for(var e=this.roleLayer.numChildren-1;e>-1;e--){var i=this.roleLayer.getChildAt(e);if(i.update(),!(i.hp<=0))for(var o=e-1;o>-1;o--){var a=this.roleLayer.getChildAt(o);if(a.hp>0&&a.camp!=i.camp){var s=i.hitRadius+a.hitRadius;Math.abs(i.x-a.x)<s&&Math.abs(i.y-a.y)<s&&(0!=i.propType||0!=a.propType?(i.eatProp(a),a.eatProp(i)):(i.lostHp(1),a.lostHp(1)))}}}Laya.timer.currFrame%(80-this.createTime)==0&&this.createEnemy(0,this.hps[0],this.speeds[0]+this.speedUp,this.nums[0]+this.numUp),Laya.timer.currFrame%(170-2*this.createTime)==0&&this.createEnemy(1,this.hps[1]+2*this.hpUp,this.speeds[1]+this.speedUp,this.nums[1]+this.numUp),Laya.timer.currFrame%(1e3-3*this.createTime)==0&&this.createEnemy(2,this.hps[2]+6*this.hpUp,this.speeds[2],this.nums[2])},t.prototype.levelUp=function(){t.score>this.levelUpScore&&(t.level++,this.hero.hp=Math.min(this.hero.hp+1*t.level,30),this.createTime=t.level<30?2*t.level:60,this.speedUp=Math.floor(t.level/6),this.hpUp=Math.floor(t.level/8),this.numUp=Math.floor(t.level/10),this.levelUpScore+=10*t.level)},t.prototype.createEnemy=function(t,e,i,o){for(var a=0;a<o;a++){var s=Laya.Pool.getItemByClass("role",l.default);s.init("enemy"+(t+1),e,i,this.radius[t],1),s.visible=!0,s.pos(640*Math.random()+50,100*-Math.random()),this.roleLayer.addChild(s)}},t.prototype.gameOver=function(){Laya.stage.offAll(),this.map.removeSelf(),this.play.removeSelf(),this.roleLayer.removeChildren(0,this.roleLayer.numChildren-1),this.roleLayer.removeSelf(),Laya.timer.clear(this,this.loop),null==this.over&&(this.over=new p.default),this.over.txt_score.text=t.score.toString(),this.over.popup(),this.over.on("reStart",this,this.gameInit)},t.level=1,t.score=0,t}();i.default=u,new u},{"./GameMap":1,"./GameOver":2,"./GamePlay":3,"./GameStart":4,"./Role":6}],6:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=Laya.Animation,a=laya.events.Event,s=t("./Main"),r=function(t){function e(){var e=t.call(this)||this;return e.hp=0,e.speed=0,e.shootInterval=300,e.shootTime=300,e.isBullet=!1,e.propType=0,e.bulletLevel=0,e.shootNum=1,e.bulletPos=[[0],[-15,15],[-30,0,30],[-45,-15,15,45]],e.roleAni=new o,e.roleAni.loadAnimation("GameRole.ani"),e}return __extends(e,t),e.prototype.init=function(t,e,i,o,s){this.type=t,this.hp=e,this.speed=i,this.hitRadius=o,this.camp=s,this.isBullet=!1,this.propType=0,this.addChild(this.roleAni),this.roleAni.on(a.COMPLETE,this,this.onComplete),this.playAction("fly")},e.prototype.onComplete=function(){if(0==this.roleAni.width){var t=this.roleAni.getBounds();this.roleAni.size(t.width,t.height)}"die"==this.action?(this.visible=!1,this.lostProp()):"hit"==this.action&&this.playAction("fly")},e.prototype.lostHp=function(t){this.hp-=t,this.hp>0?this.playAction("hit"):this.isBullet?this.visible=!1:(this.playAction("die"),"hero"==this.type?Laya.SoundManager.playSound("sound/game_over.mp3"):Laya.SoundManager.playSound("sound/enemy1_die.mp3"),"hero"==this.type||this.isBullet||s.default.score++)},e.prototype.lostProp=function(){if("enemy3"==this.type){var t=Laya.Pool.getItemByClass("role",e),i=Math.random()<.7?1:2;t.init("ufo"+i,1,2,30,1),t.propType=i,t.visible=!0,t.pos(this.x,this.y),this.parent.addChild(t)}},e.prototype.eatProp=function(t){"hero"==this.type&&0!=t.propType&&(Laya.SoundManager.playSound("sound/achievement.mp3"),1==t.propType?(s.default.score++,this.bulletLevel++,this.shootNum=Math.min(Math.floor(this.bulletLevel/2)+1,4),this.shootInterval=300-8*(this.bulletLevel>8?8:this.bulletLevel)):2==t.propType&&(this.hp+=2,s.default.score+=1),t.hp=0,t.visible=!1)},e.prototype.playAction=function(t){this.action=t,this.roleAni.play(0,!0,this.type+"_"+t)},e.prototype.update=function(){this.visible?(this.y+=this.speed,"hero"!=this.type&&(this.y>1380||this.y<-150)&&(this.visible=!1),"hero"==this.type&&(this.x<this.roleAni.width/2?this.x=this.roleAni.width/2:this.x>720-this.roleAni.width/2&&(this.x=720-this.roleAni.width/2),this.y<this.roleAni.height/2?this.y=this.roleAni.height/2:this.y>1280-this.roleAni.height/2&&(this.y=1280-this.roleAni.height/2))):"hero"!=this.type&&this.die()},e.prototype.shoot=function(){var t=Laya.Browser.now();if(t>this.shootTime)for(var i=this.bulletPos[this.shootNum-1],o=0;o<i.length;o++){this.shootTime=t+this.shootInterval;var a=Laya.Pool.getItemByClass("role",e);a.init("bullet2",1,-10,1,this.camp),a.isBullet=!0,a.visible=!0,a.pos(this.x+i[o],this.y-80),this.parent.addChild(a),Laya.SoundManager.playSound("sound/bullet.mp3")}},e.prototype.die=function(){this.roleAni.stop(),this.roleAni.offAll(),this.removeSelf(),Laya.Pool.recover("role",this)},e}(Laya.Sprite);i.default=r},{"./Main":5}],7:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=Laya.View,a=Laya.Dialog;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{width:720,height:1280},compId:1,child:[{type:"Image",props:{y:0,x:0,var:"bg1",skin:"background.png"},compId:2},{type:"Image",props:{y:-1280,x:0,var:"bg2",skin:"background.png"},compId:3}],loadList:["background.png"],loadList3D:[],components:[]},e}(o);t.GameBgUI=e;var i=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"Dialog",props:{width:720,height:1280},compId:1,child:[{type:"Image",props:{y:0,x:0,width:720,skin:"gameUI/bg.jpg",sizeGrid:"4,4,4,4",height:1280},compId:2},{type:"Image",props:{y:378,x:229,skin:"gameUI/gameOver.png"},compId:3},{type:"Text",props:{y:1200,x:19,width:681,text:"LayaAir1.7.3引擎教学演示版",height:29,fontSize:26,font:"SimHei",color:"#7c7979",bold:!0,align:"center",runtime:"laya.display.Text"},compId:5},{type:"Text",props:{y:575,x:244,width:144,text:"本局积分：",height:29,fontSize:30,font:"SimHei",color:"#7c7979",bold:!0,align:"center",runtime:"laya.display.Text"},compId:6},{type:"Text",props:{y:575,x:363,width:128,var:"txt_score",text:"1200",height:29,fontSize:30,font:"SimHei",color:"#7c7979",bold:!0,align:"center",runtime:"laya.display.Text"},compId:7},{type:"Box",props:{y:960,x:239,var:"btn_restart"},compId:10,child:[{type:"Button",props:{y:0,x:1,width:240,stateNum:2,skin:"gameUI/btn_bg.png",sizeGrid:"10,10,10,10",height:80},compId:11},{type:"Image",props:{y:18,x:41,skin:"gameUI/restart.png"},compId:12}],components:[]}],animations:[{nodes:[{target:10,keyframes:{y:[{value:970,tweenMethod:"elasticOut",tween:!0,target:10,key:"y",index:0},{value:960,tweenMethod:"linearNone",tween:!0,target:10,key:"y",index:8}]}}],name:"ani_restart",id:1,frameRate:24,action:0}],loadList:["gameUI/bg.jpg","gameUI/gameOver.png","gameUI/btn_bg.png","gameUI/restart.png"],loadList3D:[],components:[]},e}(a);t.GameOverUI=i;var s=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{width:720,height:1280},compId:1,child:[{type:"Image",props:{y:20,x:10,width:700,skin:"gameUI/blank.png",height:45},compId:7},{type:"Button",props:{y:21,x:618,var:"btn_pause",stateNum:1,skin:"gameUI/btn_pause.png"},compId:6},{type:"Text",props:{y:24,x:41,width:150,var:"txt_hp",text:"HP：",height:40,fontSize:30,font:"SimHei",bold:!0,align:"left",runtime:"laya.display.Text"},compId:8},{type:"Text",props:{y:24,x:228,width:150,var:"txt_level",text:"level：",height:40,fontSize:30,font:"SimHei",bold:!0,align:"left",runtime:"laya.display.Text"},compId:9},{type:"Text",props:{y:24,x:415,width:150,var:"txt_score",text:"Score:",height:40,fontSize:30,font:"SimHei",bold:!0,align:"left",runtime:"laya.display.Text"},compId:10},{type:"Box",props:{y:0,x:0,width:720,visible:!1,var:"gamePause",height:1280,alpha:1},compId:13,child:[{type:"Image",props:{y:0,x:0,width:720,skin:"gameUI/blank.png",sizeGrid:"2,2,2,2",height:1280},compId:15},{type:"Image",props:{y:411,x:110,width:500,visible:!0,skin:"gameUI/bg.jpg",sizeGrid:"10,10,10,10",height:500},compId:12},{type:"Text",props:{y:801,x:190,width:340,text:"点击任意位置继续游戏",height:44,fontSize:30,font:"SimHei",color:"#232222",bold:!0,align:"center",runtime:"laya.display.Text"},compId:14},{type:"Image",props:{y:468,x:214,skin:"gameUI/gamePause.png"},compId:16}],components:[]}],loadList:["gameUI/blank.png","gameUI/btn_pause.png","gameUI/bg.jpg","gameUI/gamePause.png"],loadList3D:[],components:[]},e}(o);t.GamePlayUI=s;var r=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"Dialog",props:{width:720,height:1280},compId:1,child:[{type:"Image",props:{y:0,x:0,width:720,skin:"gameUI/bg.jpg",sizeGrid:"4,4,4,4",height:1280},compId:2},{type:"Image",props:{y:378,x:179,skin:"gameUI/logo.png"},compId:3},{type:"Text",props:{y:587,x:20,width:681,var:"txt_load",text:"游戏资源加载进度",height:29,fontSize:30,font:"SimHei",color:"#1c1c1c",align:"center",runtime:"laya.display.Text"},compId:4},{type:"Box",props:{y:960,x:240,visible:!0,var:"btn_start"},compId:10,child:[{type:"Button",props:{y:0,x:0,width:240,visible:!0,stateNum:2,skin:"gameUI/btn_bg.png",sizeGrid:"20,20,20,20",height:80},compId:6},{type:"Image",props:{y:19,x:41,skin:"gameUI/start.png"},compId:11}],components:[]}],loadList:["gameUI/bg.jpg","gameUI/logo.png","gameUI/btn_bg.png","gameUI/start.png"],loadList3D:[],components:[]},e}(a);t.GameStartUI=r}(i.ui||(i.ui={}))},{}]},{},[5]);