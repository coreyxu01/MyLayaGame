var __extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function o(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();!function(){function t(e,i,o){function a(s,r){if(!i[s]){if(!e[s]){var l="function"==typeof require&&require;if(!r&&l)return l(s,!0);if(n)return n(s,!0);var p=new Error("Cannot find module '"+s+"'");throw p.code="MODULE_NOT_FOUND",p}var h=i[s]={exports:{}};e[s][0].call(h.exports,function(t){return a(e[s][1][t]||t)},h,h.exports,t,e,i,o)}return i[s].exports}for(var n="function"==typeof require&&require,s=0;s<o.length;s++)a(o[s]);return a}return t}()({1:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=t("./Role/Enemy"),a=t("./GameConst"),n=function(){function t(t){this.Main=t}return t.prototype.ResetInfo=function(){a.default.createTime=0,a.default.speedUp=0,a.default.hpUp=0,a.default.numUp=0,a.default.levelUpScore=10},t.prototype.loopCreateEnemy=function(){Laya.timer.currFrame%(80-a.default.createTime)==0&&this.createEnemy(0,a.default.hps[0],a.default.speeds[0]+a.default.speedUp,a.default.nums[0]+a.default.numUp),Laya.timer.currFrame%(170-2*a.default.createTime)==0&&this.createEnemy(1,a.default.hps[1]+2*a.default.hpUp,a.default.speeds[1]+a.default.speedUp,a.default.nums[1]+a.default.numUp),Laya.timer.currFrame%(1e3-3*a.default.createTime)==0&&this.createEnemy(2,a.default.hps[2]+6*a.default.hpUp,a.default.speeds[2],a.default.nums[2])},t.prototype.createEnemy=function(t,e,i,n){for(var s=0;s<n;s++){var r=Laya.Pool.getItemByClass("Enemy",o.default);r.init("enemy"+(t+1),e,i,a.default.radius[t],1),r.visible=!0,r.pos(640*Math.random()+50,100*-Math.random()),this.Main.roleLayer.addChild(r)}},t}();i.default=n},{"./GameConst":2,"./Role/Enemy":9}],2:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(){}return t.createTime=0,t.speedUp=0,t.hpUp=0,t.numUp=0,t.levelUpScore=10,t.hps=[1,7,15],t.nums=[2,1,1],t.speeds=[3,2,1],t.radius=[20,35,80],t.level=1,t.score=0,t}();i.default=o},{}],3:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.updateMap=function(){this.y+=1,this.bg1.y+this.y>=1280&&(this.bg1.y-=2560),this.bg2.y+this.y>=1280&&(this.bg2.y-=2560)},e}(t("./ui/layaMaxUI").ui.GameBgUI);i.default=o},{"./ui/layaMaxUI":13}],4:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function e(){var e=t.call(this)||this;return e.btn_restart.on(Laya.Event.MOUSE_DOWN,e,e.onRestart),e}return __extends(e,t),e.prototype.onRestart=function(){this.ani_restart.play(0,!1),this.ani_restart.once(Laya.Event.COMPLETE,this,this.AniComplete)},e.prototype.AniComplete=function(){this.event("reStart"),this.close()},e}(t("./ui/layaMaxUI").ui.GameOverUI);i.default=o},{"./ui/layaMaxUI":13}],5:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function e(){var e=t.call(this)||this;return e.btn_pause.on(Laya.Event.MOUSE_DOWN,e,e.onPause),e}return __extends(e,t),e.prototype.onPause=function(){this.gamePause.visible=!0,this.gamePause.once(Laya.Event.MOUSE_DOWN,this,this.onContinue),Laya.timer.scale=0},e.prototype.onContinue=function(){Laya.timer.scale=1,this.gamePause.visible=!1},e.prototype.update=function(t,e,i){this.txt_hp.text="HP:"+t,this.txt_level.text="LEVEL:"+e,this.txt_score.text="SCORE:"+i},e}(t("./ui/layaMaxUI").ui.GamePlayUI);i.default=o},{"./ui/layaMaxUI":13}],6:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function e(){var e=t.call(this)||this;return e.assetArr=[{url:"res/atlas/gameRole.atlas"},{url:"sound/achievement.mp3",type:Laya.Loader.SOUND},{url:"sound/bullet.mp3",type:Laya.Loader.SOUND},{url:"sound/game_over.mp3",type:Laya.Loader.SOUND},{url:"sound/enemy1_die.mp3",type:Laya.Loader.SOUND},{url:"sound/enemy3_out.mp3",type:Laya.Loader.SOUND}],e.btn_start.visible=!1,e.once(laya.events.Event.CLOSE,e,e.onClose),Laya.loader.load(e.assetArr,Laya.Handler.create(e,e.onComplete),Laya.Handler.create(e,e.onProgress)),e}return __extends(e,t),e.prototype.onComplete=function(){this.txt_load.text="资源加载完成,开始游戏吧...",this.btn_start.visible=!0,Laya.Tween.from(this.btn_start,{y:this.btn_start.y+20},1e3,Laya.Ease.elasticOut)},e.prototype.onProgress=function(t){this.txt_load.text="资源加载中，当前进度："+100*t+"%"},e.prototype.onClose=function(){this.removeSelf(),this.destroy()},e}(t("./ui/layaMaxUI").ui.GameStartUI);i.default=o},{"./ui/layaMaxUI":13}],7:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=Laya.WebGL,a=Laya.Stage,n=laya.events.Event,s=t("./GameStart"),r=t("./GameMap"),l=t("./GamePlay"),p=t("./GameOver"),h=t("./Role/Hero"),u=t("./EnemyManager"),d=t("./GameConst"),y=function(){function t(){this.deathTime=0,Laya.init(720,1280,o),Laya.stage.scaleMode=a.SCALE_EXACTFIT,Laya.loader.load("res/atlas/gameUI.atlas",laya.utils.Handler.create(this,this.GameStart)),this.enemyManager=new u.default(this)}return t.prototype.GameStart=function(){this.start=new s.default,this.start.popup(),this.start.btn_start.on(n.MOUSE_UP,this,this.gameInit)},t.prototype.gameInit=function(){this.start.close(),d.default.level=1,d.default.score=0,this.enemyManager.ResetInfo(),null==this.map&&(this.map=new r.default),Laya.stage.addChild(this.map),null==this.roleLayer&&(this.roleLayer=new Laya.Sprite),Laya.stage.addChild(this.roleLayer),null==this.play&&(this.play=new l.default),Laya.stage.addChild(this.play),null==this.hero&&(this.hero=new h.default),this.hero.init("hero",10,0,30,0),this.hero.visible=!0,this.hero.pos(360,800),this.roleLayer.addChild(this.hero),Laya.stage.on(n.MOUSE_DOWN,this,this.onMouseDown),Laya.stage.on(n.MOUSE_UP,this,this.onMouseUp),Laya.timer.frameLoop(1,this,this.loop)},t.prototype.onMouseDown=function(){this.moveX=Laya.stage.mouseX,this.moveY=Laya.stage.mouseY,Laya.stage.on(n.MOUSE_MOVE,this,this.onMouseMove)},t.prototype.onMouseMove=function(){var t=this.moveX-Laya.stage.mouseX,e=this.moveY-Laya.stage.mouseY;this.hero.x-=t,this.hero.y-=e,this.moveX=Laya.stage.mouseX,this.moveY=Laya.stage.mouseY},t.prototype.onMouseUp=function(){Laya.stage.off(n.MOUSE_MOVE,this,this.onMouseMove)},t.prototype.loop=function(){if(this.play.update(this.hero.hp,d.default.level,d.default.score),this.hero.hp<=0){if(this.deathTime++,this.deathTime>=100)return this.deathTime=0,void this.gameOver()}else this.levelUp();this.map.updateMap(),this.checkCollect(),this.enemyManager.loopCreateEnemy()},t.prototype.checkCollect=function(){for(var t=this.roleLayer.numChildren-1;t>-1;t--){var e=this.roleLayer.getChildAt(t);if(e.update(),!(e.hp<=0)){e.shoot();for(var i=t-1;i>-1;i--){var o=this.roleLayer.getChildAt(i);if(o.hp>0&&o.camp!=e.camp){var a=e.hitRadius+o.hitRadius;Math.abs(e.x-o.x)<a&&Math.abs(e.y-o.y)<a&&(0!=e.propType||0!=o.propType?(e.eatProp(o),o.eatProp(e)):(e.lostHp(1),o.lostHp(1)))}}}}},t.prototype.levelUp=function(){d.default.score>d.default.levelUpScore&&(d.default.level++,this.hero.hp=Math.min(this.hero.hp+1*d.default.level,30),d.default.createTime=d.default.level<30?2*d.default.level:60,d.default.speedUp=Math.floor(d.default.level/6),d.default.hpUp=Math.floor(d.default.level/8),d.default.numUp=Math.floor(d.default.level/10),d.default.levelUpScore+=10*d.default.level)},t.prototype.gameOver=function(){Laya.stage.offAll(),this.map.removeSelf(),this.play.removeSelf(),this.roleLayer.removeChildren(0,this.roleLayer.numChildren-1),this.roleLayer.removeSelf(),Laya.timer.clear(this,this.loop),null==this.over&&(this.over=new p.default),this.over.txt_score.text=d.default.score.toString(),this.over.popup(),this.over.on("reStart",this,this.gameInit)},t}();i.default=y,new y},{"./EnemyManager":1,"./GameConst":2,"./GameMap":3,"./GameOver":4,"./GamePlay":5,"./GameStart":6,"./Role/Hero":10}],8:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.lostHp=function(t){this.visible=!1},e.prototype.die=function(){t.prototype.die.call(this),Laya.Pool.recover("Bullet",this)},e}(t("./Role").default);i.default=o},{"./Role":11}],9:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=t("./Role"),a=t("./ufo"),n=t("../GameConst"),s=t("./Bullet"),r=function(t){function e(){var e=t.call(this)||this;return e.shootInterval=1e3,e}return __extends(e,t),e.prototype.lostHp=function(t){this.hp-=t,this.hp>0?this.playAction("hit"):(this.playAction("die"),n.default.score++)},e.prototype.onComplete=function(){t.prototype.onComplete.call(this),"die"==this.action?(this.visible=!1,this.lostProp()):"hit"==this.action&&this.playAction("fly")},e.prototype.lostProp=function(){if("enemy3"==this.type){var t=Laya.Pool.getItemByClass("ufo",a.default),e=Math.random()<.7?1:2;t.init("ufo"+e,1,2,30,1),t.propType=e,t.visible=!0,t.pos(this.x,this.y),this.parent.addChild(t)}},e.prototype.shoot=function(){var t=Laya.Browser.now();if(t>this.shootTime)for(var e=this.bulletPos[this.shootNum-1],i=0;i<e.length;i++){this.shootTime=t+this.shootInterval;var o=Laya.Pool.getItemByClass("Bullet",s.default);o.init("bullet1",1,10,1,this.camp),o.visible=!0,o.pos(this.x+e[i],this.y+80),this.parent.addChild(o),Laya.SoundManager.playSound("sound/bullet.mp3")}},e.prototype.die=function(){t.prototype.die.call(this),Laya.Pool.recover("Enemy",this)},e}(o.default);i.default=r},{"../GameConst":2,"./Bullet":8,"./Role":11,"./ufo":12}],10:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=t("./Role"),a=t("./Bullet"),n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.lostHp=function(t){this.hp-=t,this.hp>0||(this.playAction("die"),Laya.SoundManager.playSound("sound/game_over.mp3"),null==this.shake&&(this.shake=new Laya.Shake),this.shake.start(5,0),Laya.timer.once(1e3,this,this.stopShake))},e.prototype.stopShake=function(){null!=this.shake&&this.shake.stop()},e.prototype.eatProp=function(t){0!=t.propType&&(Laya.SoundManager.playSound("sound/achievement.mp3"),1==t.propType?(this.bulletLevel++,this.shootNum=Math.min(Math.floor(this.bulletLevel/2)+1,4),this.shootInterval=300-8*(this.bulletLevel>8?8:this.bulletLevel)):2==t.propType&&(this.hp+=2),t.hp=0,t.visible=!1)},e.prototype.update=function(){this.x<this.roleAni.width/2?this.x=this.roleAni.width/2:this.x>720-this.roleAni.width/2&&(this.x=720-this.roleAni.width/2),this.y<this.roleAni.height/2?this.y=this.roleAni.height/2:this.y>1280-this.roleAni.height/2&&(this.y=1280-this.roleAni.height/2)},e.prototype.shoot=function(){var t=Laya.Browser.now();if(t>this.shootTime)for(var e=this.bulletPos[this.shootNum-1],i=0;i<e.length;i++){this.shootTime=t+this.shootInterval;var o=Laya.Pool.getItemByClass("Bullet",a.default);o.init("bullet2",1,-10,1,this.camp),o.visible=!0,o.pos(this.x+e[i],this.y-80),o.rotation=0,this.parent.addChild(o)}},e}(o.default);i.default=n},{"./Bullet":8,"./Role":11}],11:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=Laya.Animation,a=laya.events.Event,n=function(t){function e(){var e=t.call(this)||this;return e.hp=0,e.speed=0,e.shootInterval=300,e.shootTime=300,e.propType=0,e.bulletLevel=0,e.shootNum=1,e.bulletPos=[[0],[-15,15],[-30,0,30],[-45,-15,15,45]],e.roleAni=new o,e.roleAni.loadAnimation("GameRole.ani"),e}return __extends(e,t),e.prototype.init=function(t,e,i,o,n){this.type=t,this.hp=e,this.speed=i,this.hitRadius=o,this.camp=n,this.propType=0,this.addChild(this.roleAni),this.roleAni.on(a.COMPLETE,this,this.onComplete),this.playAction("fly")},e.prototype.onComplete=function(){if(0==this.roleAni.width){var t=this.roleAni.getBounds();this.roleAni.size(t.width,t.height)}},e.prototype.lostHp=function(t){},e.prototype.eatProp=function(t){},e.prototype.playAction=function(t){this.action=t,this.roleAni.play(0,!0,this.type+"_"+t)},e.prototype.update=function(){this.visible?(this.y+=this.speed,(this.y>1380||this.y<-150)&&(this.visible=!1)):this.die()},e.prototype.shoot=function(){},e.prototype.die=function(){this.roleAni.stop(),this.roleAni.offAll(),this.removeSelf()},e}(Laya.Sprite);i.default=n},{}],12:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.lostHp=function(t){this.visible=!1},e.prototype.die=function(){t.prototype.die.call(this),Laya.Pool.recover("ufo",this)},e}(t("./Role").default);i.default=o},{"./Role":11}],13:[function(t,e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=Laya.View,a=Laya.Dialog;!function(t){var e=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{width:720,height:1280},compId:1,child:[{type:"Image",props:{y:0,x:0,var:"bg1",skin:"background.png"},compId:2},{type:"Image",props:{y:-1280,x:0,var:"bg2",skin:"background.png"},compId:3}],loadList:["background.png"],loadList3D:[],components:[]},e}(o);t.GameBgUI=e;var i=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"Dialog",props:{width:720,height:1280},compId:1,child:[{type:"Image",props:{y:0,x:0,width:720,skin:"gameUI/bg.jpg",sizeGrid:"4,4,4,4",height:1280},compId:2},{type:"Image",props:{y:378,x:229,skin:"gameUI/gameOver.png"},compId:3},{type:"Text",props:{y:1200,x:19,width:681,text:"LayaAir1.7.3引擎教学演示版",height:29,fontSize:26,font:"SimHei",color:"#7c7979",bold:!0,align:"center",runtime:"laya.display.Text"},compId:5},{type:"Text",props:{y:575,x:244,width:144,text:"本局积分：",height:29,fontSize:30,font:"SimHei",color:"#7c7979",bold:!0,align:"center",runtime:"laya.display.Text"},compId:6},{type:"Text",props:{y:575,x:363,width:128,var:"txt_score",text:"1200",height:29,fontSize:30,font:"SimHei",color:"#7c7979",bold:!0,align:"center",runtime:"laya.display.Text"},compId:7},{type:"Box",props:{y:960,x:239,var:"btn_restart"},compId:10,child:[{type:"Button",props:{y:0,x:1,width:240,stateNum:2,skin:"gameUI/btn_bg.png",sizeGrid:"10,10,10,10",height:80},compId:11},{type:"Image",props:{y:18,x:41,skin:"gameUI/restart.png"},compId:12}],components:[]}],animations:[{nodes:[{target:10,keyframes:{y:[{value:970,tweenMethod:"elasticOut",tween:!0,target:10,key:"y",index:0},{value:960,tweenMethod:"linearNone",tween:!0,target:10,key:"y",index:8}]}}],name:"ani_restart",id:1,frameRate:24,action:0}],loadList:["gameUI/bg.jpg","gameUI/gameOver.png","gameUI/btn_bg.png","gameUI/restart.png"],loadList3D:[],components:[]},e}(a);t.GameOverUI=i;var n=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"View",props:{width:720,height:1280},compId:1,child:[{type:"Image",props:{y:20,x:10,width:700,skin:"gameUI/blank.png",height:45},compId:7},{type:"Button",props:{y:21,x:618,var:"btn_pause",stateNum:1,skin:"gameUI/btn_pause.png"},compId:6},{type:"Text",props:{y:24,x:41,width:150,var:"txt_hp",text:"HP：",height:40,fontSize:30,font:"SimHei",bold:!0,align:"left",runtime:"laya.display.Text"},compId:8},{type:"Text",props:{y:24,x:228,width:150,var:"txt_level",text:"level：",height:40,fontSize:30,font:"SimHei",bold:!0,align:"left",runtime:"laya.display.Text"},compId:9},{type:"Text",props:{y:24,x:415,width:150,var:"txt_score",text:"Score:",height:40,fontSize:30,font:"SimHei",bold:!0,align:"left",runtime:"laya.display.Text"},compId:10},{type:"Box",props:{y:0,x:0,width:720,visible:!1,var:"gamePause",height:1280,alpha:1},compId:13,child:[{type:"Image",props:{y:0,x:0,width:720,skin:"gameUI/blank.png",sizeGrid:"2,2,2,2",height:1280},compId:15},{type:"Image",props:{y:411,x:110,width:500,visible:!0,skin:"gameUI/bg.jpg",sizeGrid:"10,10,10,10",height:500},compId:12},{type:"Text",props:{y:801,x:190,width:340,text:"点击任意位置继续游戏",height:44,fontSize:30,font:"SimHei",color:"#232222",bold:!0,align:"center",runtime:"laya.display.Text"},compId:14},{type:"Image",props:{y:468,x:214,skin:"gameUI/gamePause.png"},compId:16}],components:[]}],loadList:["gameUI/blank.png","gameUI/btn_pause.png","gameUI/bg.jpg","gameUI/gamePause.png"],loadList3D:[],components:[]},e}(o);t.GamePlayUI=n;var s=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.createView(e.uiView)},e.uiView={type:"Dialog",props:{width:720,height:1280},compId:1,child:[{type:"Image",props:{y:0,x:0,width:720,skin:"gameUI/bg.jpg",sizeGrid:"4,4,4,4",height:1280},compId:2},{type:"Image",props:{y:378,x:179,skin:"gameUI/logo.png"},compId:3},{type:"Text",props:{y:587,x:20,width:681,var:"txt_load",text:"游戏资源加载进度",height:29,fontSize:30,font:"SimHei",color:"#1c1c1c",align:"center",runtime:"laya.display.Text"},compId:4},{type:"Box",props:{y:960,x:240,visible:!0,var:"btn_start"},compId:10,child:[{type:"Button",props:{y:0,x:0,width:240,visible:!0,stateNum:2,skin:"gameUI/btn_bg.png",sizeGrid:"20,20,20,20",height:80},compId:6},{type:"Image",props:{y:19,x:41,skin:"gameUI/start.png"},compId:11}],components:[]}],loadList:["gameUI/bg.jpg","gameUI/logo.png","gameUI/btn_bg.png","gameUI/start.png"],loadList3D:[],components:[]},e}(a);t.GameStartUI=s}(i.ui||(i.ui={}))},{}]},{},[7]);